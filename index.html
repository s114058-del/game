<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é›™äººç®­é ­åæ‡‰éŠæˆ²</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        h1 {
            color: white;
            font-size: 3em;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .game-container {
            display: flex;
            align-items: center;
            gap: 40px;
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        .player-section {
            text-align: center;
            min-width: 200px;
        }
        
        .player-name {
            font-size: 1.8em;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
        }
        
        .player-a .player-name {
            color: #e74c3c;
        }
        
        .player-b .player-name {
            color: #3498db;
        }
        
        .score {
            font-size: 4em;
            font-weight: bold;
            color: #333;
            background: #f0f0f0;
            padding: 20px;
            border-radius: 15px;
            min-width: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        
        .check-mark, .cross-mark {
            font-size: 0.6em;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .check-mark.show, .cross-mark.show {
            opacity: 1;
        }
        
        .check-mark {
            color: #27ae60;
        }
        
        .cross-mark {
            color: #e74c3c;
        }
        
        .player-a .score {
            border: 4px solid #e74c3c;
        }
        
        .player-b .score {
            border: 4px solid #3498db;
        }
        
        .controls {
            margin-top: 15px;
            font-size: 0.9em;
            color: #666;
            line-height: 1.6;
        }
        
        .game-box {
            width: 300px;
            height: 300px;
            background: #000;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12em;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        
        .instructions {
            color: white;
            text-align: center;
            margin-top: 30px;
            font-size: 1.1em;
            max-width: 700px;
        }
        
        .status {
            color: white;
            font-size: 1.3em;
            margin-top: 20px;
            font-weight: bold;
        }
        
        button {
            background: #27ae60;
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.2em;
            border-radius: 10px;
            cursor: pointer;
            margin-top: 20px;
            transition: background 0.3s;
        }
        
        button:hover {
            background: #229954;
        }
        
        button:active {
            transform: scale(0.95);
        }
    </style>
</head>
<body>
    <h1>âš¡ é›™äººç®­é ­åæ‡‰éŠæˆ² âš¡</h1>
    
    <div class="game-container">
        <div class="player-section player-a">
            <div class="player-name">ç©å®¶ A</div>
            <div class="score" id="scoreA">
                <span class="check-mark" id="checkA">âœ“</span>
                <span>0</span>
                <span class="cross-mark" id="crossA">âœ—</span>
            </div>
            <div class="controls">
                <strong>æŒ‰éµ:</strong><br>
                W - ä¸Š â¬†ï¸<br>
                S - ä¸‹ â¬‡ï¸<br>
                A - å·¦ â¬…ï¸<br>
                D - å³ â¡ï¸
            </div>
        </div>
        
        <div class="game-box" id="gameBox"></div>
        
        <div class="player-section player-b">
            <div class="player-name">ç©å®¶ B</div>
            <div class="score" id="scoreB">
                <span class="check-mark" id="checkB">âœ“</span>
                <span>0</span>
                <span class="cross-mark" id="crossB">âœ—</span>
            </div>
            <div class="controls">
                <strong>æŒ‰éµ:</strong><br>
                â†‘ - ä¸Š â¬†ï¸<br>
                â†“ - ä¸‹ â¬‡ï¸<br>
                â† - å·¦ â¬…ï¸<br>
                â†’ - å³ â¡ï¸
            </div>
        </div>
    </div>
    
    <div class="status" id="status">æº–å‚™é–‹å§‹...</div>
    <div class="status" style="font-size: 1.5em; margin-top: 10px;" id="roundInfo">ç¬¬ 0/5 å±€</div>
    <button id="startBtn" onclick="startGame()">é–‹å§‹éŠæˆ²</button>
    
    <div class="instructions">
        <p>ğŸ® éŠæˆ²è¦å‰‡ï¼šé»‘è‰²æ–¹å¡Šæœƒåœ¨éš¨æ©Ÿæ™‚é–“å¾Œï¼Œå¿«é€Ÿé¡¯ç¤º4å€‹ç®­é ­EMOJI</p>
        <p>âš¡ ç®­é ­ä¸€å‡ºç¾å°±å¯ä»¥æ¶ç­”ï¼æ¯”æ‹¼æ‰‹é€Ÿå’Œåæ‡‰ï¼</p>
        <p>ğŸ”¥ é›£åº¦éå¢ï¼šç¬¬1å±€0.5ç§’ â†’ ç¬¬2å±€0.4ç§’ â†’ ç¬¬3å±€0.3ç§’ â†’ ç¬¬4å±€0.2ç§’ â†’ ç¬¬5å±€0.1ç§’</p>
        <p>âœ… ç­”å°å¾—1åˆ† | âŒ ç­”éŒ¯æ‰£1åˆ† | å…±5å±€</p>
    </div>
    
    <script>
        const arrows = ['â¬†ï¸', 'â¬‡ï¸', 'â¬…ï¸', 'â¡ï¸'];
        let scoreA = 0;
        let scoreB = 0;
        let currentSequence = [];
        let currentIndexA = 0;
        let currentIndexB = 0;
        let pressCountA = 0;
        let pressCountB = 0;
        let isPlaying = false;
        let waitingForInput = false;
        let currentRound = 0;
        let totalRounds = 5;
        let showingArrows = false;
        
        const gameBox = document.getElementById('gameBox');
        const scoreAEl = document.getElementById('scoreA');
        const scoreBEl = document.getElementById('scoreB');
        const statusEl = document.getElementById('status');
        const startBtn = document.getElementById('startBtn');
        const roundInfoEl = document.getElementById('roundInfo');
        const checkA = document.getElementById('checkA');
        const crossA = document.getElementById('crossA');
        const checkB = document.getElementById('checkB');
        const crossB = document.getElementById('crossB');
        
        function updateScores() {
            scoreAEl.querySelector('span:nth-child(2)').textContent = scoreA;
            scoreBEl.querySelector('span:nth-child(2)').textContent = scoreB;
        }
        
        function updateRoundInfo() {
            roundInfoEl.textContent = `ç¬¬ ${currentRound}/5 å±€`;
        }
        
        function getRandomArrow() {
            return arrows[Math.floor(Math.random() * arrows.length)];
        }
        
        function getDirectionFromKey(key) {
            const keyMap = {
                'w': 'â¬†ï¸', 'W': 'â¬†ï¸',
                's': 'â¬‡ï¸', 'S': 'â¬‡ï¸',
                'a': 'â¬…ï¸', 'A': 'â¬…ï¸',
                'd': 'â¡ï¸', 'D': 'â¡ï¸',
                'ArrowUp': 'â¬†ï¸',
                'ArrowDown': 'â¬‡ï¸',
                'ArrowLeft': 'â¬…ï¸',
                'ArrowRight': 'â¡ï¸'
            };
            return keyMap[key];
        }
        
        function getPlayerFromKey(key) {
            if (['w', 'W', 's', 'S', 'a', 'A', 'd', 'D'].includes(key)) {
                return 'A';
            } else if (['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight'].includes(key)) {
                return 'B';
            }
            return null;
        }
        
        async function showSequence() {
            currentSequence = [];
            for (let i = 0; i < 4; i++) {
                currentSequence.push(getRandomArrow());
            }
            
            // æ ¹æ“šå±€æ•¸æ±ºå®šé€Ÿåº¦ï¼šç¬¬1å±€0.5ç§’ï¼Œç¬¬2å±€0.4ç§’ï¼Œç¬¬3å±€0.3ç§’ï¼Œç¬¬4å±€0.2ç§’ï¼Œç¬¬5å±€0.1ç§’
            const speeds = [500, 400, 300, 200, 100];
            const displayTime = speeds[currentRound - 1];
            
            showingArrows = true;
            currentIndexA = 0;
            currentIndexB = 0;
            pressCountA = 0;
            pressCountB = 0;
            waitingForInput = true; // ç®­é ­ä¸€å‡ºç¾å°±å¯ä»¥é–‹å§‹æŒ‰éµï¼
            statusEl.textContent = 'ç®­é ­å‡ºç¾ï¼å¿«æŒ‰éµæ¶ç­”ï¼';
            
            for (let i = 0; i < currentSequence.length; i++) {
                gameBox.textContent = currentSequence[i];
                await new Promise(resolve => setTimeout(resolve, displayTime));
                
                // æ¯å€‹ç®­é ­ä¹‹é–“ç©ºç™½0.1ç§’
                if (i < currentSequence.length - 1) {
                    gameBox.textContent = '';
                    await new Promise(resolve => setTimeout(resolve, 100));
                }
            }
            
            // ç®­é ­é¡¯ç¤ºå®Œç•¢ï¼Œç¹¼çºŒä½œç­”
            showingArrows = false;
            gameBox.textContent = '';
            gameBox.style.background = '#000';
            
            // å¦‚æœé‚„æ²’å®Œæˆï¼Œæç¤ºç¹¼çºŒä½œç­”
            if (pressCountA < 4 || pressCountB < 4) {
                statusEl.textContent = 'ç¹¼çºŒè¼¸å…¥å‰©é¤˜ç®­é ­ï¼';
            }
        }
        
        async function startRound() {
            if (!isPlaying) return;
            
            currentRound++;
            updateRoundInfo();
            
            if (currentRound > totalRounds) {
                endGame();
                return;
            }
            
            waitingForInput = false;
            currentIndexA = 0;
            currentIndexB = 0;
            pressCountA = 0;
            pressCountB = 0;
            gameBox.textContent = '';
            gameBox.style.background = '#000';
            
            const waitTime = Math.floor(Math.random() * 6000) + 1000;
            statusEl.textContent = `ç¬¬ ${currentRound} å±€ - ç­‰å¾…ä¸­...`;
            
            await new Promise(resolve => setTimeout(resolve, waitTime));
            
            if (isPlaying) {
                statusEl.textContent = 'ç®­é ­å‡ºç¾ï¼å¿«æŒ‰éµï¼';
                await showSequence();
            }
        }
        
        function endGame() {
            isPlaying = false;
            waitingForInput = false;
            startBtn.textContent = 'é–‹å§‹éŠæˆ²';
            
            let winner = '';
            if (scoreA > scoreB) {
                winner = 'ç©å®¶Aç²å‹ï¼ğŸ‰';
                gameBox.textContent = 'ğŸ†';
                gameBox.style.background = '#e74c3c';
            } else if (scoreB > scoreA) {
                winner = 'ç©å®¶Bç²å‹ï¼ğŸ‰';
                gameBox.textContent = 'ğŸ†';
                gameBox.style.background = '#3498db';
            } else {
                winner = 'å¹³æ‰‹ï¼ğŸ¤';
                gameBox.textContent = 'ğŸ¤';
                gameBox.style.background = '#f39c12';
            }
            
            statusEl.textContent = `éŠæˆ²çµæŸï¼${winner} (${scoreA} : ${scoreB})`;
        }
        
        function handleKeyPress(e) {
            if (!waitingForInput || !isPlaying) return;
            
            const direction = getDirectionFromKey(e.key);
            const player = getPlayerFromKey(e.key);
            
            if (!direction || !player) return;
            
            e.preventDefault();
            
            // æª¢æŸ¥è©²ç©å®¶æ˜¯å¦å·²ç¶“æŒ‰äº†4æ¬¡
            if (player === 'A' && pressCountA >= 4) return;
            if (player === 'B' && pressCountB >= 4) return;
            
            // ç©å®¶Aå’Œç©å®¶Båˆ†åˆ¥è¿½è¹¤è‡ªå·±çš„é€²åº¦
            let currentIndex = player === 'A' ? currentIndexA : currentIndexB;
            
            // æª¢æŸ¥è©²ç©å®¶æ˜¯å¦å·²å®Œæˆæ‰€æœ‰ç®­é ­
            if (currentIndex >= currentSequence.length) return;
            
            const correctArrow = currentSequence[currentIndex];
            
            // åˆ¤æ–·æ˜¯å¦æ­£ç¢ºï¼šæŒ‰éµæ–¹å‘å¿…é ˆå°æ‡‰EMOJIç®­é ­æ–¹å‘
            if (direction === correctArrow) {
                // ç­”å°ï¼šåŠ åˆ†ä¸¦å‰é€²åˆ°ä¸‹ä¸€å€‹ç®­é ­
                if (player === 'A') {
                    scoreA++;
                    currentIndexA++;
                    pressCountA++;
                    checkA.classList.add('show');
                    setTimeout(() => checkA.classList.remove('show'), 300);
                } else {
                    scoreB++;
                    currentIndexB++;
                    pressCountB++;
                    checkB.classList.add('show');
                    setTimeout(() => checkB.classList.remove('show'), 300);
                }
            } else {
                // ç­”éŒ¯ï¼šæ‰£åˆ†ä¸”æŒ‰éµæ¬¡æ•¸+1ï¼Œä½†ä¸å‰é€²ï¼ˆå¯ä»¥ç¹¼çºŒå˜—è©¦åŒä¸€å€‹ç®­é ­ï¼‰
                if (player === 'A') {
                    scoreA--;
                    pressCountA++;
                    crossA.classList.add('show');
                    setTimeout(() => crossA.classList.remove('show'), 300);
                } else {
                    scoreB--;
                    pressCountB++;
                    crossB.classList.add('show');
                    setTimeout(() => crossB.classList.remove('show'), 300);
                }
            }
            
            updateScores();
            
            // ç•¶å…©ä½ç©å®¶éƒ½æŒ‰äº†4æ¬¡å¾Œæ‰é€²å…¥ä¸‹ä¸€å±€ï¼ˆä¸ç®¡æœ‰æ²’æœ‰å…¨éƒ¨ç­”å°ï¼‰
            if (pressCountA >= 4 && pressCountB >= 4) {
                waitingForInput = false;
                statusEl.textContent = `ç¬¬ ${currentRound} å±€å®Œæˆï¼æº–å‚™ä¸‹ä¸€å±€...`;
                setTimeout(() => {
                    if (isPlaying) {
                        startRound();
                    }
                }, 1500);
            }
        }
        
        function startGame() {
            if (isPlaying) {
                isPlaying = false;
                startBtn.textContent = 'é–‹å§‹éŠæˆ²';
                statusEl.textContent = 'éŠæˆ²ä¸­æ­¢';
                waitingForInput = false;
                gameBox.textContent = '';
                gameBox.style.background = '#000';
            } else {
                scoreA = 0;
                scoreB = 0;
                currentRound = 0;
                updateScores();
                updateRoundInfo();
                isPlaying = true;
                startBtn.textContent = 'åœæ­¢éŠæˆ²';
                statusEl.textContent = 'éŠæˆ²é–‹å§‹ï¼';
                startRound();
            }
        }
        
        document.addEventListener('keydown', handleKeyPress);
    </script>
</body>
</html>